%
% set initial iterate value
% iterate = 
% AGL 08/21/06 - Iterate for which rfactor = 0.2697

%iterate(1).x=[ -1.8757 -1.7941 -1.8067 -0.3861 0.2472 -0.0461 0.0690 0.1874 1.7112 1.7350 1.7378 1.7467 1.7751 1.7897 0 3.1141 3.0047 6.2250 -4.0621 1.2552 3.6738 -4.2907 5.0398 0 5.0355 2.4703 2.5445 2.4371 0 0 -3.0047 1.2913 6.2250 1.2552 1.2125 3.7093 0 0 5.0355 5.0402 0 2.4371]';
%iterate(1).p={1 1 1 1 1 2 2 2 2 2 2 2 2 2}; %best known solution!
% point 4
iterate(1).x=[   -2.0076436998   -1.7135782485   -1.7929755104   -0.4506145816   -0.1722271207   -0.0229373989   -0.0299759672    0.3213585701    1.7401502035    1.8828917058    1.8516028013    1.6782861415    1.6459063955    1.7824073724   -0.0330598880    2.9203372361    3.1638769664    6.3738490471    6.1703524105    1.1705241836    3.6491663472    3.7756024146    4.9543802626   -0.1201314815    5.0235130572    5.0336705985    2.5930295556    2.3775509097   -0.0149667744    2.9612248069   -0.0079330223    1.4448152266    3.8772517141    1.1204637326    1.2594383120    3.6189433057    0.0035879639   -0.0627531220    5.0890397954    2.5255883517   -0.0203690480    2.2316675319]';
iterate(1).p={  2  2  2  1  1  1  2  1  1  2  2  1  1  2};

x0 = iterate(1).x; % set of z,x,y coordinates for 14 atoms
p  = cell2mat(iterate(1).p); % integer array holding atom type
disp(x0);
disp(p);
%
% other options
xlower = x0 - max(1.0,abs(x0));
xupper = x0 + max(1.0,abs(x0));
fmax   = 1.0;

[ x, fx, msg, wrn, neval, f_hist] = bfo(@(x)tleedfcn(x,p), x0, ...
        'epsilon', 0.0001, 'maxeval', 2000, ... 
        'xlower', xlower, 'xupper', xupper, ...
        'save-freq', 10, 'restart-file', 'bfo.restart'); %...
        %'f-call-type', 'with-bound', ...
        %'f-bound', fbound);